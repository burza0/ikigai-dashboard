import{d as e,r as t,p as a,o as s,c as r,b as l,e as i,f as o,j as n,k as d,m as c,q as u,F as g,l as y,g as p}from"./vendor-vue-21xXbNRb.js";import{_ as x}from"./feature-analytics-Bl__O72l.js";import"./vendor-http-CtpuQClY.js";import"./vendor-charts-m3kAu5OU.js";const m={class:"max-w-7xl mx-auto p-6 space-y-6"},v={class:"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-4"},b={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},w={class:"lg:col-span-1 space-y-6"},k={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},h={key:0,class:"space-y-4"},f={class:"text-center p-4 bg-gradient-to-r from-purple-100 to-orange-100 dark:from-purple-900 dark:to-orange-900 rounded-lg"},_={class:"text-3xl mb-2"},z={class:"font-bold text-gray-900 dark:text-white"},j={class:"text-sm text-gray-600 dark:text-gray-400 mt-2"},P={key:0,class:"space-y-2"},S={class:"flex justify-between text-sm text-gray-600 dark:text-gray-400"},T={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3"},C={class:"space-y-1"},q={class:"flex flex-wrap gap-2"},I={class:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700"},O={class:"text-center"},W={class:"text-xl font-bold text-gray-900 dark:text-white"},$={class:"text-center"},D={class:"text-xl font-bold text-gray-900 dark:text-white"},L={key:1,class:"text-center py-8 text-gray-500"},M={class:"lg:col-span-1 space-y-6"},A={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},G={key:0,class:"space-y-4"},K={class:"flex items-start justify-between mb-3"},N={class:"flex-1"},E={class:"flex items-center mb-2"},J={class:"text-2xl mr-2"},Z={class:"font-semibold text-gray-900 dark:text-white"},B={class:"text-sm text-gray-600 dark:text-gray-400"},F={class:"space-y-2"},U={class:"flex justify-between text-sm"},H={class:"text-gray-600 dark:text-gray-400"},Q={class:"text-orange-600 dark:text-orange-400 font-medium"},R={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},V={key:0,class:"flex items-center text-green-600 dark:text-green-400 text-sm"},X={key:1,class:"text-xs text-gray-500 dark:text-gray-500"},Y={key:1,class:"text-center py-8 text-gray-500"},ee={class:"lg:col-span-1 space-y-6"},te={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},ae={key:0,class:"space-y-4"},se={class:"flex items-start justify-between mb-3"},re={class:"flex items-center"},le={class:"text-2xl mr-3"},ie={class:"font-semibold text-gray-900 dark:text-white"},oe={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},ne={class:"flex items-center justify-between"},de={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},ce=["onClick","disabled"],ue={key:0},ge={key:1},ye={key:1,class:"text-center py-8 text-gray-500"},pe={key:0,class:"fixed bottom-6 right-6 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center"},xe={key:1,class:"fixed top-6 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-purple-500 to-orange-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 flex items-center"},me={class:"font-bold"},ve={class:"text-sm opacity-90"},be="web_user",we=x(e({__name:"LoyaltyProgram",emits:["navigate"],setup(e){const x=t(null),we=t(null),ke=t(null),he=t([]),fe=t([]),_e=t(""),ze=t(""),je=t(0),Pe=a((()=>ke.value&&x.value?ke.value.points_required-x.value.points:0)),Se=a((()=>{if(!ke.value||!x.value||!we.value)return 100;const e=x.value.points,t=we.value.points_required,a=(e-t)/(ke.value.points_required-t)*100;return Math.min(Math.max(a,0),100)})),Te=async()=>{try{const e=await fetch(`http://localhost:5001/api/loyalty/profile/${be}`),t=await e.json();if("success"===t.status){x.value=t.data;const e=[{level:1,name:"🌱 Wellness Starter",badge:"🌱",points_required:0,benefits:["5% zniżka na pierwszą mieszankę"]},{level:2,name:"🌿 Health Enthusiast",badge:"🌿",points_required:500,benefits:["10% stała zniżka","Dostęp do ekskluzywnych składników"]},{level:3,name:"🏆 Wellness Warrior",badge:"🏆",points_required:1500,benefits:["15% stała zniżka","Darmowa mieszanka co miesiąc","Priorytet w nowych składnikach"]},{level:4,name:"👑 IKIGAI Master",badge:"👑",points_required:3500,benefits:["20% stała zniżka","2 darmowe mieszanki miesięcznie","Bezpłatna dostawa","Ekskluzywne wydarzenia"]}],a=t.data.points;let s=e[0],r=e[1];for(let t=0;t<e.length&&a>=e[t].points_required;t++)s=e[t],r=e[t+1]||null;we.value=s,ke.value=r}}catch(e){}},Ce=async()=>{try{const e=await fetch(`http://localhost:5001/api/loyalty/challenges/${be}`),t=await e.json();if("success"===t.status){const e=t.data.map((e=>{return{...e,icon:(t=e.id,{daily_protein:"💪",weekly_variety:"🌈",monthly_eco:"🌱",healthy_week:"🥗",vegan_warrior:"🌿",protein_power:"💪",early_bird:"🌅",mix_master:"🎨"}[t]||"🎯"),expires_date:e.expires};var t}));he.value=e}}catch(e){}},qe=async()=>{try{const e=await fetch("http://localhost:5001/api/loyalty/rewards"),t=await e.json();if("success"===t.status){const e=t.data.map((e=>{return{...e,points_cost:e.cost,icon:(t=e.id,{free_small:"🎁",free_premium:"💎",discount_20:"💸",ikigai_bottle:"🍶",nutrition_guide:"👨‍⚕️",free_topping:"🍓",free_base:"🥣",free_mix:"🎁",double_points:"⚡",exclusive_ingredient:"⭐"}[t]||"🏆")};var t}));fe.value=e}}catch(e){}},Ie=async()=>{try{const e=Math.floor(15*Math.random())+5,t=await fetch("http://localhost:5001/api/loyalty/points/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:be,order_amount:e,reason:"Symulowane zamówienie"})}),a=await t.json();a.success&&(_e.value=`${a.message}! (${e}zł)`,a.level_up&&(je.value=a.new_level,ze.value=`Osiągnięto nowy poziom: ${a.new_level}!`,setTimeout((()=>{ze.value=""}),5e3)),await Te(),await Oe("healthy_week"),setTimeout((()=>{_e.value=""}),3e3))}catch(e){}},Oe=async e=>{try{const t=await fetch("http://localhost:5001/api/loyalty/challenge/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:be,challenge_type:e})}),a=await t.json();if(a.success&&a.completed_challenges.length>0){for(const e of a.completed_challenges)_e.value=`🎯 Ukończono wyzwanie: ${e.challenge.name}! +${e.reward_points} punktów`;await Ce()}}catch(t){}},We=async()=>{await Promise.all([Te(),Ce(),qe()]),_e.value="Dane zostały odświeżone!",setTimeout((()=>{_e.value=""}),2e3)};return s((async()=>{await Promise.all([Te(),Ce(),qe()])})),(e,t)=>(l(),r("div",m,[i("div",v,[i("button",{onClick:t[0]||(t[0]=t=>e.$emit("navigate","dashboard")),class:"hover:text-purple-600 dark:hover:text-purple-400 transition-colors duration-200"}," 🏠 Dashboard "),t[3]||(t[3]=i("span",{class:"mx-2"},"/",-1)),t[4]||(t[4]=i("span",{class:"text-purple-600 dark:text-purple-400 font-medium"},"🏆 Program Lojalnościowy",-1))]),t[25]||(t[25]=o('<div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-8 text-white" data-v-a352ec4b><div class="flex items-center mb-4" data-v-a352ec4b><div class="w-12 h-12 mr-4 bg-white rounded-full flex items-center justify-center" data-v-a352ec4b><span class="text-2xl" data-v-a352ec4b>🏆</span></div><div data-v-a352ec4b><h1 class="text-3xl font-bold" data-v-a352ec4b>Program Lojalnościowy IKIGAI</h1><p class="text-orange-100 mt-2" data-v-a352ec4b>Zbieraj punkty, podejmuj wyzwania, zyskuj nagrody za zdrowy styl życia</p></div></div></div>',1)),i("div",b,[i("div",w,[i("div",k,[t[12]||(t[12]=i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center"},[i("span",{class:"text-2xl mr-3"},"👤"),d(" Twój Profil IKIGAI ")],-1)),x.value?(l(),r("div",h,[i("div",f,[i("div",_,c(we.value?.badge),1),i("div",z,c(we.value?.name),1),i("div",j,c(x.value.points)+" / "+c(ke.value?.points_required||"∞")+" punktów ",1)]),ke.value?(l(),r("div",P,[i("div",S,[t[5]||(t[5]=i("span",null,"Postęp do następnego poziomu",-1)),i("span",null,c(Pe.value)+" punktów",1)]),i("div",T,[i("div",{class:"bg-gradient-to-r from-orange-500 to-purple-500 h-3 rounded-full transition-all duration-300",style:u({width:`${Se.value}%`})},null,4)])])):n("",!0),i("div",null,[t[7]||(t[7]=i("h4",{class:"font-semibold text-gray-900 dark:text-white mb-2"},"🎁 Twoje korzyści",-1)),i("div",C,[(l(!0),r(g,null,y(we.value?.benefits,(e=>(l(),r("div",{key:e,class:"text-sm text-gray-600 dark:text-gray-400 bg-green-50 dark:bg-green-900/20 px-3 py-2 rounded-lg flex items-center"},[t[6]||(t[6]=i("span",{class:"text-green-600 mr-2"},"✓",-1)),d(" "+c(e),1)])))),128))])]),i("div",null,[t[8]||(t[8]=i("h4",{class:"font-semibold text-gray-900 dark:text-white mb-2"},"🏅 Odznaki",-1)),i("div",q,[(l(!0),r(g,null,y(x.value.badges,(e=>(l(),r("span",{key:e.id||e.name||e,class:"text-2xl p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-700"},c((e=>{if("string"==typeof e)return e;if(e&&e.name)return{"Pierwszy Krok":"🥇","Tygodniowy Streak":"🔥","Eco Warrior":"🌱"}[e.name]||"🏅";return"🏅"})(e)),1)))),128))])]),i("div",I,[i("div",O,[i("div",W,c(x.value.total_orders),1),t[9]||(t[9]=i("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Zamówienia",-1))]),i("div",$,[i("div",D,c(x.value.total_spent?.toFixed(2))+"zł",1),t[10]||(t[10]=i("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Wydane",-1))])])])):(l(),r("div",L,t[11]||(t[11]=[i("div",{class:"text-4xl mb-4"},"🔄",-1),i("p",null,"Ładowanie profilu...",-1)])))]),i("div",{class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},[t[16]||(t[16]=i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"⚡ Szybkie akcje",-1)),i("div",{class:"space-y-3"},[t[15]||(t[15]=i("li",{class:"flex items-center text-base text-gray-700 dark:text-gray-300"},[i("span",{class:"mr-2"},"🥣"),d(" Skomponuj bowl (+punkty) ")],-1)),i("button",{onClick:Ie,class:"w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center"},t[13]||(t[13]=[i("span",{class:"mr-2"},"🎯",-1),d(" Symuluj zamówienie ")])),i("button",{onClick:We,class:"w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center"},t[14]||(t[14]=[i("span",{class:"mr-2"},"🔄",-1),d(" Odśwież dane ")]))])])]),i("div",M,[i("div",A,[t[20]||(t[20]=i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center"},[i("span",{class:"text-2xl mr-3"},"🎯"),d(" Wyzwania Tygodniowe ")],-1)),he.value.length>0?(l(),r("div",G,[(l(!0),r(g,null,y(he.value,(e=>{return l(),r("div",{key:e.id,class:"border border-gray-200 dark:border-gray-600 rounded-lg p-4"},[i("div",K,[i("div",N,[i("div",E,[i("span",J,c(e.icon),1),i("h4",Z,c(e.name),1)]),i("p",B,c(e.description),1)]),i("div",{class:p(["px-2 py-1 rounded-full text-xs font-medium","easy"===e.difficulty?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"medium"===e.difficulty?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},c(e.difficulty),3)]),i("div",F,[i("div",U,[i("span",H," Postęp: "+c(e.progress)+"/"+c(e.target),1),i("span",Q,c(e.reward_points)+" punktów ",1)]),i("div",R,[i("div",{class:p(["h-2 rounded-full transition-all duration-300","completed"===e.status?"bg-green-500":"bg-orange-500"]),style:u({width:e.progress/e.target*100+"%"})},null,6)]),"completed"===e.status?(l(),r("div",V,t[17]||(t[17]=[i("span",{class:"mr-1"},"✅",-1),d(" Ukończone! ")]))):(l(),r("div",X," Wygasa: "+c((a=e.expires_date,new Date(a).toLocaleDateString("pl-PL",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}))),1))])]);var a})),128))])):(l(),r("div",Y,[t[18]||(t[18]=i("div",{class:"text-4xl mb-4"},"🎯",-1)),t[19]||(t[19]=i("p",null,"Brak aktywnych wyzwań",-1)),i("button",{onClick:Ce,class:"mt-4 text-orange-600 hover:text-orange-700 text-sm"}," Wczytaj wyzwania ")]))])]),i("div",ee,[i("div",te,[t[22]||(t[22]=i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center"},[i("span",{class:"text-2xl mr-3"},"🏪"),d(" Sklep Nagród ")],-1)),fe.value.length>0?(l(),r("div",ae,[(l(!0),r(g,null,y(fe.value,(e=>(l(),r("div",{key:e.id,class:"border border-gray-200 dark:border-gray-600 rounded-lg p-4"},[i("div",se,[i("div",re,[i("span",le,c(e.icon),1),i("div",null,[i("h4",ie,c(e.name),1),i("p",oe,c(e.description),1)])])]),i("div",ne,[i("div",de,c(e.points_cost)+" punktów ",1),i("button",{onClick:t=>(async e=>{if(x.value&&!(x.value.points<e.points_cost))try{const t=await fetch("http://localhost:5001/api/loyalty/redeem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:be,reward_id:e.id})}),a=await t.json();a.success&&(_e.value=a.message,x.value.points=a.remaining_points,setTimeout((()=>{_e.value=""}),3e3))}catch(t){}})(e),disabled:!x.value||x.value.points<e.points_cost,class:p(["px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200",x.value&&x.value.points>=e.points_cost?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"])},[x.value&&x.value.points>=e.points_cost?(l(),r("span",ue,"🎁 Wymień")):(l(),r("span",ge,"💸 Za mało punktów"))],10,ce)])])))),128))])):(l(),r("div",ye,t[21]||(t[21]=[i("div",{class:"text-4xl mb-4"},"🏪",-1),i("p",null,"Ładowanie sklepu...",-1)])))])])]),_e.value?(l(),r("div",pe,[t[23]||(t[23]=i("span",{class:"text-xl mr-3"},"🎉",-1)),i("span",null,c(_e.value),1),i("button",{onClick:t[1]||(t[1]=e=>_e.value=""),class:"ml-4 text-white hover:text-gray-200"},"✕")])):n("",!0),ze.value?(l(),r("div",xe,[t[24]||(t[24]=i("span",{class:"text-2xl mr-3"},"🎊",-1)),i("div",null,[i("div",me,"Gratulacje! Awans na poziom "+c(je.value)+"!",1),i("div",ve,c(ze.value),1)]),i("button",{onClick:t[2]||(t[2]=e=>ze.value=""),class:"ml-4 text-white hover:text-gray-200"},"✕")])):n("",!0)]))}}),[["__scopeId","data-v-a352ec4b"]]);export{we as default};
